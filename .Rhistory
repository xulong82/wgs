geom_label_repel(aes(label = label))
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(5, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label))
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(5, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label))
dev.off()
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(4, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label))
dev.off()
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label))
dev.off()
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_text_repel(aes(label = label))
dev.off()
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_text_repel(aes(label = label), nudge_x = 0.5)
dev.off()
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_text_repel(aes(label = label), nudge_x = c(0.1, 0.1, 0.1, 0), nudge_y = c(0, 0, 0, 0.1))
dev.off()
head(gwas)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_text_repel(aes(label = label), nudge_x = c(0, 0.1, 0.1, 0.1), nudge_y = c(0, 0, 0, 0.1))
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_text_repel(aes(label = label), nudge_x = c(0.1, 0.1, 0.1, 0), nudge_y = c(0, 0, 0, 0.1))
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_text_repel(aes(label = label), nudge_x = c(0.1, 0, 0.1, 0.1), nudge_y = c(0, 0, 0, 0.1))
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_text_repel(aes(label = label), nudge_x = c(0.1, 0, 0.1, 0.1), nudge_y = c(0, 0.1, 0, 0))
dev.off()
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_text_repel(aes(label = label), nudge_x = c(0.1, 0, 0.1, 0.1), nudge_y = c(0, 0.2, 0, 0))
dev.off()
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_text_repel(aes(label = label), nudge_x = c(0.1, -0.01, 0.1, 0.1), nudge_y = c(0, 0.2, 0, 0))
dev.off()
head(gwas)
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], colour="green", aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label), nudge_x = c(0.1, -0.01, 0.1, 0.1), nudge_y = c(0, 0.2, 0, 0))
dev.off()
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label), nudge_x = c(0.1, -0.01, 0.1, 0.1), nudge_y = c(0, 0.2, 0, 0))
dev.off()
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, shape = 2),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label), nudge_x = c(0.1, -0.01, 0.1, 0.1), nudge_y = c(0, 0.2, 0, 0))
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, font = "bold"),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label), nudge_x = c(0.1, -0.01, 0.1, 0.1), nudge_y = c(0, 0.2, 0, 0))
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, font = 2),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label), nudge_x = c(0.1, -0.01, 0.1, 0.1), nudge_y = c(0, 0.2, 0, 0))
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, shape = "bold"),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label), nudge_x = c(0.1, -0.01, 0.1, 0.1), nudge_y = c(0, 0.2, 0, 0))
pdf("./Manu/top2.pdf", width = 7, height = 4)
ggplot(gwas, aes(x = MAF, y = abs(mean))) +
geom_point(data = gwas[1:4, ], aes(size = -log10(P)), shape = 1) +
# geom_point(aes(colour = Sign, size = -log10(P), shape = Type), alpha = 0.8) +
geom_point(aes(colour = Sign, size = -log10(P)), alpha = 0.7) +
scale_size(range = c(3, 8), breaks = seq(6, 9, 0.5)) +
theme_bw() + xlab("MAF") + ylab("Absolute Effect Size") +
guides(color = F, text = F, shape = F) +
scale_color_manual(values = c("dodgerblue3", "firebrick1")) +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, face = "bold"),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
geom_label_repel(aes(label = label), nudge_x = c(0.1, -0.01, 0.1, 0.1), nudge_y = c(0, 0.2, 0, 0))
dev.off()
load("~/Dropbox/GitHub/wgs/gwas/sampling.rdt")
mcmc$UID = gsub(":", "-", gsub("_.*", "", rownames(mcmc)))
load("~/Dropbox/GitHub/wgs/glm/vep.rdt")
head(vep)
vep$UID = gsub(":", "-", gsub("-.*", "", vep$Location))
vep[vep$Consequence == "missense_variant", ]
unique(vep[vep$Consequence == "missense_variant", "SYMBOL"])
gwas = mcmc[mcmc$P < 1e-6, ]
vep1 = vep[vep$UID %in% gwas$UID, ]
sort(table(vep1$Consequence))
sort(table(vep1$Consequence) / nrow(vep1))
gwas$CHR = as.numeric(gsub(":.*", "", rownames(gwas)))
gwas$POS = as.numeric(gsub("^.*:(.*)_.*", "\\1", rownames(gwas)))
grp <- list(); grp[[1]] <- gwas[1, ]; grp_idx <- 1
for (i in 2:nrow(gwas)) {
chr = gwas$CHR[i] == gwas$CHR[i-1]; pos = gwas$POS[i] - gwas$POS[i-1] < 1e6
if ( all(chr, pos) ) grp[[grp_idx]] = rbind(grp[[grp_idx]], gwas[i, ])
else { grp_idx = grp_idx + 1; grp[[grp_idx]] = gwas[i, ] }
}
sapply(grp, nrow)
gwas <- do.call(rbind, lapply(grp, function(x) cbind(PEAK = x$UID[which.min(x$P)], x)))
(peaks = as.character(unique(gwas$PEAK)))
table = cbind(gwas[match(vep1$UID, gwas$UID), ], vep1)
head(table)
table(consequences)
table(table$consequences)
table(table$Consequences)
table(table$Consequence)
barplot(table(table$Consequence))
x = table(table$Consequence)
x
x = sort(x)
x
x = table(table$Consequence)
x = sort(x, decreasing = T)
x
barplot(x)
x = as.data.frame(x)
x
x$feature = rownames(x)
x
ggplot(x, aes(x = feature, y = x))
ggplot(x, aes(x = feature, y = x)) + geom_barplot(stat = "identity")
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity")
x = table(table$Consequence)
x = sort(x, decreasing = T)
x = as.data.frame(x)
x$feature = as.factor(rownames(x), levels = rownames(x))
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity")
x = table(table$Consequence)
x = sort(x, decreasing = T)
x = as.data.frame(x)
x$feature = factor(rownames(x), levels = rownames(x))
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity")
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity") + coord_flip()
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity") + coord_flip() + geom_label(aes(lable = x))
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity") + coord_flip() + geom_label(aes(label = x))
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity") + coord_flip() + geom_label(aes(label = x)) +
theme_bw() + xlab("") + ylab("-log10(P)") + guides(shape = F, color = F) +
)
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity") + coord_flip() + geom_label(aes(label = x)) +
theme_bw() + xlab("") + ylab("-log10(P)") + guides(shape = F, color = F)
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity") + coord_flip() + geom_label(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences")
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity") + coord_flip() + geom_label_repel(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences")
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label_repel(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences")
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label_repel(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences")
getwd()
pdf("Manu/cons.pdf", width = 4, height = 6)
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label_repel(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences")
dev.off()
pdf("Manu/cons.pdf", width = 8, height = 6)
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label_repel(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences")
dev.off()
pdf("Manu/cons.pdf", width = 8, height = 4)
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label_repel(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences")
dev.off()
pdf("Manu/cons.pdf", width = 7, height = 4)
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label_repel(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences") +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, face = "bold"),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank()) +
dev.off()
dev.off()
pdf("Manu/cons.pdf", width = 7, height = 4)
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label_repel(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences") +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, face = "bold"),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank())
dev.off()
dev.off()
dev.off()
pdf("Manu/cons.pdf", width = 7, height = 4)
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label_repel(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences") +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, face = "bold"),
legend.text = element_text(size = 15),
#       legend.position = "top",
legend.key = element_blank())
dev.off()
pdf("Manu/cons.pdf", width = 8, height = 4)
ggplot(x, aes(x = feature, y = x)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences") +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, face = "bold"),
legend.text = element_text(size = 15),
legend.key = element_blank())
dev.off()
x = table(table$Consequence)
x = as.data.frame(x)
x
x = table(table$Consequence)
x = as.data.frame(x)
x
x$feature = x$Var1
x$feature[grep("intron", x$feature)] = "intron"
x$feature = x$Var1
x$feature[grep("intron", x$feature)] = "intron"
x
x$feature = x$Var1
x$feature[grepl("intron", x$feature)] = "intron_variant"
x
x = table$Consequence
x
x[grep("intron", x)] = "intron_variant"
x
x = table(x$Consequence)
x = table(x)
x
x = table$Consequence
x[grep("intron", x)] = "intron_variant"
x = as.data.frame(table(x))
x
x = x[sort(x$Freq, decreasing = T), ]
x
x = table$Consequence
x[grep("intron", x)] = "intron_variant"
x = as.data.frame(table(x))
x = x[order(x$Freq, decreasing = T), ]
x
ggplot(x, aes(x = x, y = Freq)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences") +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, face = "bold"),
legend.text = element_text(size = 15),
legend.key = element_blank())
x$feature = factor(x$x, levels = x$x)
ggplot(x, aes(x = feature, y = Freq)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences") +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, face = "bold"),
legend.text = element_text(size = 15),
legend.key = element_blank())
pdf("Manu/cons.pdf", width = 8, height = 4)
ggplot(x, aes(x = feature, y = Freq)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label(aes(label = x)) +
theme_bw() + xlab("") + ylab("Number of consequences") +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, face = "bold"),
legend.text = element_text(size = 15),
legend.key = element_blank())
dev.off()
pdf("Manu/cons.pdf", width = 8, height = 4)
ggplot(x, aes(x = feature, y = Freq)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label(aes(label = Freq)) +
theme_bw() + xlab("") + ylab("Number of consequences") +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, face = "bold"),
legend.text = element_text(size = 15),
legend.key = element_blank())
dev.off()
head(table)
pdf("Manu/cons.pdf", width = 8, height = 4)
ggplot(x, aes(x = feature, y = Freq)) + geom_bar(stat = "identity", width = 0.5) +
coord_flip() + geom_label(aes(label = Freq)) +
theme_bw() + xlab("") + ylab("Number of annotations") +
theme(axis.text = element_text(size = 15),
axis.title= element_text(size = 15, face = "bold"),
legend.text = element_text(size = 15),
legend.key = element_blank())
dev.off()
